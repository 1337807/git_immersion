<!doctype html>
<html>
  <head>
    <link href="labs.css" media="screen,print" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <header>
      <a href="http://edgecase.com">
        <img id="logo" src="edgecase.gif"\ >
      </a>
      <div class="title">Git Immersion Labs</div>
      <nav>
  <ul>
    <li>
              <a href="lab_22.html">&laquo; Previous Lab</a>
          </li>
    <li>
      <a href="index.html">Index</a>
    </li>
    <li>
              <a href="lab_24.html">Next Lab &raquo;</a>
          </li>
  </ul>
</nav>

    </header>
    <section id="main">
      <article>
        <h1>Lab 23:  Git Internals: Working directly with Git Objects</h1>
<h2>Goals</h2>
<ul>
	<li>Explore the structure of the object store</li>
	<li>Learn how to use the SHA1 hashes to find content in the repository</li>
</ul>
<h2>Steps</h2>
<p>Now let&#8217;s use some tools to probe git objects directly.</p>
<h3>Finding the Latest Commit</h3>
<p class="command">Execute:</p>
<pre class="instructions">git hist --max-count=1</pre>
<p>This should show the latest commit made in the repository.  The SHA1 hash on your system is probably different that what is on mine, but you should see something like this.</p>
<p class="command">Output:</p>
<pre class="sample">$ git hist --max-count=1
* d4258dd 2010-12-28 | Added a Rakefile. (HEAD, master) [Jim Weirich]</pre>
<h3>Dumping the Latest Commit</h3>
<p>Using the SHA1 hash from the commit listed above &#8230;</p>
<p class="command">Execute:</p>
<pre class="instructions">git cat-file -t &lt;hash&gt;
git cat-file -p &lt;hash&gt;</pre>
<p>Here&#8217;s my output &#8230;</p>
<p class="command">Output:</p>
<pre class="sample">$ git cat-file -t d4258dd
commit
$ git cat-file -p d4258dd
tree 096b74c56bfc6b40e754fc0725b8c70b2038b91e
parent 0179abfa425af7ba26f14f614c0209c7fba03490
author Jim Weirich &lt;jim.weirich@gmail.com&gt; 1293568394 -0500
committer Jim Weirich &lt;jim.weirich@gmail.com&gt; 1293568394 -0500

Added a Rakefile.
</pre>
<p style="padding-left:4em;" class="note"><strong><span class="caps">NOTE</span>:</strong> If you defined the &#8216;type&#8217; and &#8216;dump&#8217; aliases from the aliases lab, then you can type <code>git type</code> and <code>git dump</code> rather than the longer cat-file commands (which I never remember).</p>
<p>This is the dump of the commit object that is at the head of the master branch.  It looks a lot like the commit object from the presentation earlier.</p>
<h3>Finding the Tree</h3>
<p>We can dump the directory tree referenced in the commit.  This should be a description of the (top level) files in our project (for that commit).  Use the SHA1 hash from the &#8220;tree&#8221; line listed above.</p>
<p class="command">Execute:</p>
<pre class="instructions">git cat-file -p &lt;treehash&gt;</pre>
<p>Here&#8217;s what my tree looks like&#8230;</p>
<p class="command">Output:</p>
<pre class="sample">$ git cat-file -p 096b74c
100644 blob 28e0e9d6ea7e25f35ec64a43f569b550e8386f90	Rakefile
040000 tree e46f374f5b36c6f02fb3e9e922b79044f754d795	lib
</pre>
<p>Yep, I see the Rakefile and the lib directory.</p>
<h3>Dumping the lib directory</h3>
<p class="command">Execute:</p>
<pre class="instructions">git cat-file -p &lt;libhash&gt;</pre>
<p class="command">Output:</p>
<pre class="sample">$ git cat-file -p e46f374
100644 blob c45f26b6fdc7db6ba779fc4c385d9d24fc12cf72	hello.rb
</pre>
<p>There&#8217;s the <code>hello.rb</code> file.</p>
<h3>Dumping the <code>hello.rb</code> file</h3>
<p class="command">Execute:</p>
<pre class="instructions">git cat-file -p &lt;rbhash&gt;</pre>
<p class="command">Output:</p>
<pre class="sample">$ git cat-file -p c45f26b
# Default is World
# Author: Jim Weirich (jim@somewhere.com)
name = ARGV.first || "World"

puts "Hello, #{name}!"
</pre>
<p>There you have it.  We&#8217;ve dumped commit objects, tree objects and blob objects directly from the git repository.  That&#8217;s all that is there, blobs, trees and commits.</p>
<h3>Explore On You Own</h3>
<p>Explore the git repo manually on your own.  See if you can find the original hello.rb file from the very first commit by manually following the SHA1 hash references starting in the latest commit.</p>
      </article>
    </section>
    <footer>
      <nav>
  <ul>
    <li>
              <a href="lab_22.html">&laquo; Previous Lab</a>
          </li>
    <li>
      <a href="index.html">Index</a>
    </li>
    <li>
              <a href="lab_24.html">Next Lab &raquo;</a>
          </li>
  </ul>
</nav>

   </footer>
  </body>
</html>
